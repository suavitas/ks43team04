<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
     xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
     layout:decorate="~{layouts/userDefault}">     

<!-- 사용자 정의 JsScript 파일-->
<th:block layout:fragment="customJsScript">
   <!-- 주소검색 API -->
   <script th:src="@{//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js}"></script>
         <script>
         // 카카오 우편번호 API 
         function searchAddForm() {
              new daum.Postcode({
                  oncomplete: function(data) {
                     
                     var addr = '';
                     var extraAddr = ''; // 참고항목 변수

                      //사용자가 선택한 주소 타입에 따라 해당 주소 값을 가져온다.
                      if (data.userSelectedType === 'R') { // 사용자가 도로명 주소를 선택했을 경우
                          addr = data.roadAddress;
                      } else { // 사용자가 지번 주소를 선택했을 경우(J)
                          addr = data.jibunAddress;
                      }
                      
                      document.getElementById('memberPostNum').value = data.zonecode;
                      document.getElementById('memberAddr').value = addr;
                      // 커서를 상세주소 필드로 이동한다.
                      document.getElementById('memberDetailAddr').focus();
                      
                  }
              }).open();
          }
      </script>
      <script>
      function searchLaundryAddForm() {
           new daum.Postcode({
               oncomplete: function(data) {
                  
                  var addr = '';
                  var extraAddr = ''; // 참고항목 변수

                   //사용자가 선택한 주소 타입에 따라 해당 주소 값을 가져온다.
                   if (data.userSelectedType === 'R') { // 사용자가 도로명 주소를 선택했을 경우
                       addr = data.roadAddress;
                   } else { // 사용자가 지번 주소를 선택했을 경우(J)
                       addr = data.jibunAddress;
                   }
                   
                   document.getElementById('laundryPostNum').value = data.zonecode;
                   document.getElementById('laundryAddr').value = addr;
                   // 커서를 상세주소 필드로 이동한다.
                   document.getElementById('laundryDetailAddr').focus();
                   
               }
           }).open();
       }
      </script>
</th:block>

<th:block layout:fragment="customJsScript2">
 <script type="text/javascript">
		var genderCheck = document.querySelector('#gender-check').value;
		var gender = document.querySelectorAll('.gender');
		
		for(var i=0; i<gender.length; i++){
			if(gender[i].value == genderCheck){
				gender[i].checked = true
			}
		
		for(var j=0; j<gender.length; j++){
			gender[j].addEventListener('click',function(e){
				for(var k=0; k<gender.length; k++){
					gender[k].checked = false;
				}
				e.target.checked = true;
			});
		}
	}
   </script>
 </th:block>


<style>
     min-height: 100vh;

    .input-form {
      max-width: 800px;

      margin-top: 100px;
      margin-bottom: 100px;
      padding: 32px;

      background: #fff;
      -webkit-border-radius: 10px;
      -moz-border-radius: 10px;
      border-radius: 10px;
      -webkit-box-shadow: 0 8px 20px 0 rgba(0, 0, 0, 0.15);
      -moz-box-shadow: 0 8px 20px 0 rgba(0, 0, 0, 0.15);
      box-shadow: 0 8px 20px 0 rgba(0, 0, 0, 0.15);
    }
    textarea {
      position: relative;
      overflow: auto;
      height: 100px;
      border: 1px solid #dadada;
      box-sizing: border-box;
   }
</style>
</th:block>

<!-- 사용자정의 contents -->
<th:block layout:fragment="customContents">
   <!-- 게시판 타이틀 -->
   <div id="container">
      <div id="top-loca">
         <div class="boardPath">
            <a th:href="@{/}">HOME</a>           
            <h2 style="font-family: 'ONE-Mobile-Regular'">[[${sessionName}]]</h2><span>님의 마이페이지</span>
         </div>   
      </div>
   </div>   
      
   <!-- 게시판 탭  -->         
   <div class="list-group list-group-horizontal col-sm-12" style="margin:0 auto; text-align: center;padding-right: 0px;">
        <a th:href="@{/user/myPage}" class="list-group-item list-group-item-action active" style="background-color: #F28123; border-color: #F28123;" aria-current="true">
        회원정보
        </a>
      <a th:href="@{/user/myPageReservationStatus}" class="list-group-item list-group-item-action">예약 현황</a>
      <a href="#" class="list-group-item list-group-item-action">수거배송 조회</a>
      <a th:href="@{/user/myPagePayment}" class="list-group-item list-group-item-action">결제 내역</a>
      <a href="#" class="list-group-item list-group-item-action">환불 내역</a>
      <a th:href="@{/user/myPagePoint}" class="list-group-item list-group-item-action">포인트 조회</a>
      <a th:href="@{/user/myPageWrite}" class="list-group-item list-group-item-action">내가 쓴 글</a>
      <a href="#" class="list-group-item list-group-item-action">리뷰?</a>
   </div>
   
   
   <!-- 공지사항 테이블 -->
   <div class="cart-section mt-150 mb-150" style="background-color: #f5f6fa; padding: 60px 0 100px; margin: 0; border-top: #e5e5e5 1px solid;">
      <div class="container">
         <div class="row" style="float: none; margin: 100 auto;">
            <div class="col-lg-8 col-lg-12" style="float: none; margin:0 auto;">

        <div class="container"  style="margin-top: 80px; margin-bottom: 100px;">
          <div class="input-form-backgroud row">
            <div class="input-form col-md-12 mx-auto" >
              <form th:action="@{/user/modifyUser}" method="post" class="validation-form" novalidate>
                  <div id="cid_1" class="form-input-wide" data-layout="full" >
                    <div data-component="separator" style="border-top:1px solid rgb(0,0,0); clear:both;"></div>
             </div>
             <div>
               <table class="table table-bordered mt-6">
                  <thead>
                     <tr>
                        <th scope="col" style="width: 10%;">#</th>
								<th scope="col"><strong>내 정보관리</strong></th>
					</tr>
					  </thead>  
			          <tbody>
			        	<tr>
							<th scope="row" style="text-align: center;">회원 정보</th>
								<td>
					<div class="mb-3" style="margin: 20px auto; display: none;">
						<label for="LevelCode"><strong>회원레벨코드</strong></label> 
						<input type="text" class="form-control" id="LevelCode" name="LevelCode" th:value="${member.LevelCode}" />
					</div>
					
					<div class="mb-3"  style="margin: 20px auto;"> 
						<label for="password"><strong>아이디</strong></label> 
						<div style="display: flex;">
							<input type="text" class="form-control" name="memberId" id="memberId" style="width: 85%;" th:value="${member.memberId}" readonly="readonly">	
							<button type="button" class="btn btn-success" id="idCheck" style="width: 20%;">중복체크</button>
						</div>
							<div>
								<span id="idCheckResult"></span>
							</div>
					</div>			

					<div class="mb-3" style="margin: 20px auto;">
						<label for="password"><strong>비밀번호</strong></label> 
						<input type="text" class="form-control" id="memberPw" name="memberPw" th:value="${member.memberPw}" />
					</div>
					
					<div class="mb-3" style="margin: 20px auto;">
						<label for="email"><strong>이름</strong></label>
						<input type="email" class="form-control" id="memberName" name="memberName" th:value="${member.memberName}" />
					</div>

					<div class="mb-3" style="margin: 20px auto;">
						<label for="birth"><strong>생년월일</strong></label> 
						<input type="date" class="form-control" id="memberBirth" name="memberBirth" th:value="${member.memberBirth}" />
					</div>

					<div class="mb-3" style="margin: 20px auto;">
						<label for="email"><strong>주소</strong></label> 
						<div style="display: flex;">
							<input type="text" class="form-control" name="memberPostNumber" id="memberPostNum" placeholder="우편번호" style="width: 85%;" th:value="${member.memberPostNumber}" />
							<button type="button" class="btn btn-success" id="memberPostNum" name="memberPostNum" style="width: 20%;" onclick="searchAddForm()">우편찾기</button>				
						</div>
					</div>	
					<div class="mb-3" style="margin: 20px auto;">			
							<input type="text" class="form-control" name="memberAddr" id="memberAddr" placeholder="주소" style="width: 85%;" th:value="${member.memberAddr}" />
					</div>
					<div class="mb-3" style="margin: 20px auto;">			
							<input type="text" class="form-control" name="memberDetailAddr" id="memberDetailAddr" placeholder="상세주소" style="width: 85%;" th:value="${member.memberDetailAddr}" />
					</div>

					<div class="mb-3" style="margin: 20px auto;">
						<label for="phone"><strong>전화번호</strong></label> 
						<input type="text" class="form-control" id="memberPhone" name="memberPhone" placeholder="전화번호 입력" style="width: 85%;" th:value="${member.memberPhone}" />
					</div>
					
					<div class="mb-3" style="margin: 20px auto;">
						<label for="gen"><strong>성별 선택</strong></label> 
  						<input type="hidden" id="gender-check" class="form-control" th:value="${member.memberGender}" />
						<input type='checkbox' class="gender" name='memberGender' value="여" style="margin: 20px;" /><strong>여성</strong>
						<input type='checkbox' class="gender" name='memberGender' value="남" style="margin: 20px;" /><strong>남성</strong>
					</div>

					<div class="mb-3" style="margin: 20px auto;">
						<label for="email"><strong>이메일</strong></label> 
						<input type="text" class="form-control" id="memberEmail" name="memberEmail" placeholder="이메일 입력" th:value="${member.memberEmail}" />
					</div>
	
					</tbody> 	
					<th:block th:if="${session.SLEVEL == 'level_code_03'|| session.SLEVEL == 'level_code_02'}">
						<div id="cid_1" class="form-input-wide" data-layout="full" >
					           <div data-component="separator" style="border-top:1px solid rgb(0,0,0); clear:both;"></div>
					    </div> 	
							<table class="table table-bordered mt-6">
					      		<thead>
									<tr>
										<th scope="col" style="width: 10%;">#</th>
										<th scope="col"><strong>세탁소 사업장 관리</strong></th>
									</tr>
						  		</thead>  
						        <tbody>
						        	<tr th:if="${not #lists.isEmpty(member.laundryList)}" th:each=" l : ${member.laundryList}">
										<th scope="row" style="text-align: center;">세탁소 정보</th>
											<td> 				          
										<div class="mb-3"  style="margin: 20px auto; display: none;">
											<label for="name"><strong>세탁소 코드</strong></label> 
												<input type="text" class="form-control" id="laundryCode" name="laundryCode" style="width: 85%;" th:value="${l.laundryCode}" />	
										</div>
										<div class="mb-3"  style="margin: 20px auto;">
											<label for="name"><strong>세탁소 명</strong></label> 
												<input type="text" class="form-control" id="laundryName" name="laundryName" style="width: 85%;" th:value="${l.laundryName}" />	
										</div>
								      
								        <div class="mb-3" style="margin: 20px auto;">
											<label for="num"><strong>사업자등록번호</strong></label> 
											<input type="text" class="form-control" id="businessNumber" name="businessNumber" th:value="${l.businessNumber}" />
										</div>
					
													
										<div class="mb-3" style="margin: 20px auto;">
											<label for="phone"><strong>세탁소 대표번호</strong></label> 
											<input type="text" class="form-control" id="laundryTel" name="laundryTel" placeholder="대표전화 입력" style="width: 85%;" th:value="${l.laundryTel}" />
										</div>
					
										<div class="mb-3" style="margin: 20px auto;">
											<label for="addr"><strong>세탁소 주소</strong></label> 
											<div style="display: flex;">
												<input type="text" class="form-control" name="laundryPostNumber" id="laundryPostNum" placeholder="우편번호" style="width: 85%;" th:value="${l.laundryPostNumber}" />
												<button type="button" class="btn btn-success" id="laundryPostNum" name="laundryPostNum" style="width: 20%;" onclick="searchLaundryAddForm()">우편찾기</button>				
											</div>
										</div>
										<div class="mb-3" style="margin: 20px auto;">			
												<input type="text" class="form-control" name="laundryAddr" id="laundryAddr" placeholder="주소" style="width: 85%;" th:value="${l.laundryAddr}" />
										</div>
										<div class="mb-3" style="margin: 20px auto;">			
												<input type="text" class="form-control" name="laundryDetailAddr" id="laundryDetailAddr" placeholder="상세주소" style="width: 85%;" th:value="${l.laundryDetailAddr}" />
										</div>
									</td>
								</tr>
							</tbody>
					  </table>
				</th:block>	
				</table>
						<div class="ln_solid"></div>
								<div class="form-group" style="margin: 5%">
									<div class="col-md-12 col-sm-12 text-center">
										<a th:href="@{/user/modifyUser(memberId=${member.memberId})}"><button type="button" class="btn btn-success" id="modifyButton">수정</button></a>
										<button type="submit" class="btn btn-info">저장</button>
									</div>
								</div>		
							</div>
						 </form>
						</div>
					 </div>					
				  </div>				
			  </div>				
		   </div>			
		</div>
	</div>
   </th:block>
</html>

  