<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	  layout:decorate="~{layouts/adminDefault}">
	  
	<th:block layout:fragment="customScript">
		<script type="text/javascript" th:src="@{/js/jquery-3.6.0.min.js}"></script>
	</th:block>	
		
	<th:block layout:fragment="customJsScript"> 
		<script type="text/javascript">
		
		/*새로고침 후 탭 유지*/
		$(document).ready(function() {
		    if (location.hash) {
		        $("a[href='" + location.hash + "']").tab("show");
		    }
		    $(document.body).on("click", "a[data-toggle='tab']", function(event) {
		        location.hash = this.getAttribute("href");
		    });
		});
		$(window).on("popstate", function() {
		    var anchor = location.hash || $("a[data-toggle='tab']").first().attr("href");
		    $("a[href='" + anchor + "']").tab("show");
		});
		
		/*Data Table*/
		$(document).ready(function () {
		    $('.table').DataTable({
		    	stateSave: true,
		    	destroy : true,
		    	ordering: false,
		    	order: [ [ 1, "desc" ] ],
		    	autowidth: false
		    });
		});
		
		</script>
		
		<style>
			ul.bar_tabs {
				background: none;
				z-index: auto;
				margin-top: 50px !important;
			}
			table.dataTable {
				border-collapse: collapse !important;
				width: 100%;
			}			
			.btn-secondary {
				position:absolute; 
				right:40px; 
				top:120px; 
				z-index: 1;
				margin: 0; 
				float: right;
			}
			.table-striped td{
				vertical-align: middle;
			}
			.table-striped tr{
				text-align: center;
			}			
		</style>
	</th:block>		
	  
	<!-- 사용자정의 contents -->
	<th:block layout:fragment="customContents">
	
		<!-- 탭 이름 -->
		<h4><strong>이벤트 관리</strong></h4>
			<!-- 본문 내용 시작 -->
			<div class="container" style="margin-top: 50px;">
				<div class="col-md-12 col-sm-12">
					<div class="x_panel">
						<!-- 게시판 타이틀 -->
			 			<h4 style="margin: 20px;">이벤트</h4>
							<div class="x_title">	
								<!-- 등록 버튼 --> 	
								<a th:href="@{/admin/eventForm}"><button type="button" class="btn btn-secondary">등록하기</button></a>	
										
							<!-- 탭 -->
							<div class="x_content">
								<ul class="nav nav-tabs bar_tabs" id="myTab" role="tablist">
									<li class="nav-item">
										<a class="nav-link active" id="home-tab" data-toggle="tab" href="#eventTotal" role="tab" aria-controls="home" aria-selected="true">전체</a>
									</li>
									<li class="nav-item">
										<a class="nav-link" id="profile-tab" data-toggle="tab" href="#eventContinue" role="tab" aria-controls="profile" aria-selected="false">진행중</a>
									</li>
									<li class="nav-item">
										<a class="nav-link" id="contact-tab" data-toggle="tab" href="#eventEnd" role="tab" aria-controls="contact" aria-selected="false">종료</a>
									</li>
								</ul>
								
							<!-- (1)전체 이벤트 -->
							<div class="tab-content" id="myTabContent">
								<div class="tab-pane fade active show" id="eventTotal" role="tabpanel" aria-labelledby="home-tab">				
									<table id="datatable-fixed-header" class="table table-striped table-bordered" style="width: 100%;">
										<thead>
											<tr>
												<th style="width: 5%;">번호</th>
												<th style="width: 8%;">진행상태</th>
												<th style="width: 45%;">제목</th>
												<th style="width: 6%;">첨부</th>
												<th style="width: 10%;">작성자</th>
												<th style="width: 20%;">작성일</th>
												<th style="width: 6%;">조회</th>
											</tr>
										</thead>
											<tr th:if="${not #lists.isEmpty(eventList)}" th:each="l, status : ${eventList}">
												<td th:text="${l.eventNo}"></td>
												<th:block th:if="${l.eventState == '진행중'}">
												<td th:text="${l.eventState}"></td>
												<td style="text-align: left;">
													<strong><a th:href="@{/admin/eventDetail(eventCode=${l.eventCode})}" th:text="${l.eventTitle}"></a></strong>
												</td>
												</th:block>
												<th:block th:unless="${l.eventState == '진행중'}">
												<td th:text="${l.eventState}"></td>
												<td style="text-align: left;">
													<strong><a th:href="@{/admin/eventDetail(eventCode=${l.eventCode})}" th:text="${l.eventTitle}"></a></strong>
												</td>
												</th:block>
												<td>
													<th:block th:if="${l.eventAddFile=='1'}">
														<i class="fa fa-save"></i>
													</th:block>
													<th:block th:unless="${l.eventAddFile=='1'}">
													</th:block>
												</td>
												<td>
													<th:block th:if="${l.memberId=='id001'}">
														<span style="text-align: center; color: #212529;">관리자</span>
													</th:block>
												</td>
												<td th:text="${l.registTime}"></td>
												<td th:text="${l.eventReadCount}"></td>
											</tr>
											<tr th:unless="${not #lists.isEmpty(eventList)}">
												<td colspan="7">조회된 내용이 없습니다.</td>
											</tr>
									</table>
								</div>
								
							<!-- (2)진행중 이벤트 -->			
							<div class="tab-pane fade" id="eventContinue" role="tabpanel" aria-labelledby="profile-tab">
								<table id="datatable-fixed-header" class="table table-striped table-bordered" style="width: 100%;">
									<thead>
										<tr>
											<th>번호</th>
											<th>진행상태</th>
											<th>제목</th>
											<th>첨부</th>
											<th>작성자</th>
											<th>작성일</th>
											<th>조회</th>	
										</tr>
									</thead>
										<tr th:if="${not #lists.isEmpty(runEventList)}" th:each="l, status : ${runEventList}">
											<!-- <td th:text="${#numbers.formatIntege((th:maxlength=${runEventList})-status.count+1})"></td> -->
											<td style="width: 5%;" th:text="${runeventListCount-status.count+1}"></td>
											<td style="width: 8%;" th:text="${l.eventState}"></td>
											<td style="width: 45%; text-align: left;">
												<strong><a th:href="@{/admin/eventDetail(eventCode=${l.eventCode})}" th:text="${l.eventTitle}"></a></strong>
											</td>
											<td style="width: 6%;">
												<th:block th:if="${l.eventAddFile=='1'}">
													<i class="fa fa-save"></i>
												</th:block>
												<th:block th:unless="${l.eventAddFile=='1'}">
												</th:block>
											</td>
											<td style="width: 10%;">
												<th:block th:if="${l.memberId=='id001'}">
													<span style="text-align: center; color: #212529;">관리자</span>
												</th:block>
											</td>
											<td style="width: 20%;" th:text="${l.registTime}"></td>
											<td style="width: 6%;" th:text="${l.eventReadCount}"></td>
										</tr>
										<tr th:unless="${not #lists.isEmpty(runEventList)}">
											<td colspan="7">조회된 내용이 없습니다.</td>
										</tr>
								</table>
							</div>
				
							<!-- (3)종료 이벤트 -->					
							<div class="tab-pane fade" id="eventEnd" role="tabpanel" aria-labelledby="contact-tab">
								<table id="datatable-fixed-header" class="table table-striped table-bordered" style="width: 100%;">
									<thead>
										<tr>
											<th>번호</th>
											<th>진행상태</th>
											<th>제목</th>
											<th>첨부</th>
											<th>작성자</th>
											<th>작성일</th>
											<th>조회</th>	
										</tr>
									</thead>
										<tr th:if="${not #lists.isEmpty(endEventList)}" th:each="l, status : ${endEventList}">
											<td style="width: 5%;" th:text="${endeventListCount-status.count+1}"></td>
											<td style="width: 8%;" th:text="${l.eventState}"></td>
											<td style="width: 45%; text-align: left;">
												<strong><a th:href="@{/admin/eventDetail(eventCode=${l.eventCode})}" th:text="${l.eventTitle}"></a></strong>
											</td>
											<td style="width: 6%;">
												<th:block th:if="${l.eventAddFile=='1'}">
													<i class="fa fa-save"></i>
												</th:block>
												<th:block th:unless="${l.eventAddFile=='1'}">
												</th:block>
											</td>
											<td style="width: 10%;">
												<th:block th:if="${l.memberId=='id001'}">
													<span style="text-align: center; color: #212529;">관리자</span>
												</th:block>
											</td>
											<td style="width: 20%;" th:text="${l.registTime}"></td>
											<td style="width: 6%;" th:text="${l.eventReadCount}"></td>
										</tr>
										<tr th:unless="${not #lists.isEmpty(endEventList)}">
											<td colspan="7">조회된 내용이 없습니다.</td>
										</tr>
								</table>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</th:block>

</html>