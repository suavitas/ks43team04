<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	  layout:decorate="~{layouts/adminDefault}">
	 
 	<th:block layout:fragment="customCss">
		<link rel="stylesheet" th:href="@{https://cdn.datatables.net/1.10.20/css/jquery.dataTables.min.css}">
	</th:block>	  
	
	<th:block layout:fragment="customScript">
		<script type="text/javascript" th:src="@{/js/jquery-3.6.0.min.js}"></script>
	</th:block>	
		
	<th:block layout:fragment="customJsScript"> 
		<script type="text/javascript">
				
		$(document).ready(function () {
		    $('.table').DataTable({
		    	stateSave: true,
		    	destroy : true,
		    	ordering: false,
		    	order: [ [ 1, "asc" ] ],
		    	autowidth: false
		    });
		});
			
		</script>
	</th:block>	 
	  
	  
	<!-- 사용자정의 contents -->	
	<th:block layout:fragment="customContents">
	
	<style>
	.dataTables_wrapper .dataTables_paginate .paginate_button { 
	padding:0 !important; 
	margin:0 !important;
	}
	.dataTables_wrapper	{		
   		height: 600px!important;		
	}	
	#pickupList td {
		vertical-align: middle;
	}
	#pickupList {
		text-align: center;
	}
	.x_content {
		padding-top:20px;
	}
	.putitle {
		margin-top: 20px; 
		padding-left: 10px;
	}
	</style>
	
	<!-- 라이더 배정 Modal -->
		<div class="modal fade" id="staticBackdrop" data-backdrop="static" data-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
			<div class="modal-dialog">
				<div class="modal-content">
		      		<div class="modal-header">
		        		<h5 class="modal-title" id="staticBackdropLabel">배송기사 배정</h5>
		        			<button type="button" class="close" data-dismiss="modal" aria-label="Close">
		          				<span aria-hidden="true">&times;</span>
		        			</button>
					</div>		      
						<form class="pickup" th:action="@{/admin/pickUpByStore}" method="POST">		      
							<div class="modal-body">  
								<div style="text-align: center">
								<h5 style="margin-bottom: 30px; margin-top: 20px;">배송기사를 배정해주세요.</h5>
								<p>배정을 완료해야 수거가 시작됩니다.</p>
									<select>
									<th:block th:each="c : ${getRiderList}">
										<option th:text="${c.headRiderConpanyName}" th:value="${c.headRiderConpanyName}"></option>
									</th:block>
									</select>
										
										
											
								</div>
					      </div>
					      <div class="modal-footer">
					        <button type="button" class="btn btn-secondary" data-dismiss="modal">취소</button>
					        <a th:href="@{/admin/pickUpByStore}"><button type="button" class="btn btn-success">배정</button></a>
					      </div>
						</form>
					</div>
				</div>
			</div>	

	<!-- 탭 이름 -->
	<h4><strong>수거 현황</strong></h4>
		<!-- 본문 내용 시작 -->
		<div class="container" style="margin-top: 50px;">
			<div class="col-md-12 col-sm-12">
				<div class="x_panel">
					<!-- 게시판 타이틀 -->
		 			<th:block th:each="l : ${getMemberLaundryList}">
						<h2 th:text="${l.laundryName}" style="font-size: 30px;"></h2>
					</th:block>
						<h2 class="putitle"><strong>[[${sessionName}]]</strong><span> 님의 수거 현황</span></h2>
							<div class="x_title">					
								<div class="x_content">
									<div class="row">
										<div class="col-sm-12">
											<div class="card-box table-responsive">	
												<!-- 테이블 -->
												<table id="pickupList" class="table table-striped table-bordered" style="width: 100%;">
													<thead>
														<tr>			
															<th>고객 이름</th>
															<th>수거 희망일</th>
															<th>수거 완료일</th>
															<th>요청 사항</th>	
															<th>수거 담당</th>	
															<th>배정</th>
														</tr>
													</thead>
													<tbody>
														<tr th:if="${not #lists.isEmpty(pickUpListByStore)}" th:each="l : ${pickUpListByStore}">
															<th:block th:each="s, status : ${l.memberList}">
																<td th:text="${s.memberName}"></td>
															</th:block>
																<td th:text="${l.pickupWantDate}"></td> 
																<td th:text="${l.pickupFinishTime}"></td>
															<th:block th:each="r, status : ${l.requestList}">
																<td th:text="${r.requestCate}"></td>
															</th:block>
															<th:block th:each="c, status : ${l.contractRiderList}">
																<td th:text="${c.headRiderConpanyName}"></td>
															</th:block>
																<td><button type="button" class="btn btn-success btn-sm" id="riderselect"  data-toggle="modal" data-target="#staticBackdrop">
																	수거 기사 배정</button>
																</td>	
														</tr>
														<tr th:unless="${not #lists.isEmpty(pickUpListByStore)}">
															<td colspan="6">조회된 내용이 없습니다.</td>
														</tr>
													</tbody>
												</table>
											</div>
										</div>	
									</div>	
								</div>
							</div>
						</div>	
					</div>
				</div>
</html>