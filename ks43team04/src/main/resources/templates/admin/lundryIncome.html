<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layouts/adminDefault}">

<!-- 사용자정의 contents -->
<th:block layout:fragment="customContents">
	<div class="x_title">
		<h2>[[${sessionName}]] 님 세탁소</h2>
		<h2>매장 월별 매출액</h2>
		</div>
	
	<div class="clearfix"></div>
	<table class="table table-striped jambo_table bulk_action">
		<tbody>
			<tr>
				<th>매출 합계 =</th>
				<th id="finalMoney" style="color: red"></th>
			</tr>
		</tbody>
	</table>
	<table id="laundryIncome"
		class="table table-striped jambo_table bulk_action"
		style="width: 100%;">
		<thead>
			<tr>
				<th>세탁소명</th>
				<th>회원 아이디</th>
				<th>회원 이름</th>
				<th>결제 금액</th>
				<th>결제 날짜</th>

			</tr>
		</thead>
		<tbody id="tBody">
			<tr th:if="${not #lists.isEmpty(laundryByIncome)}"
				th:each="l : ${laundryByIncome}">
				<td th:text="${l.get('laundryName')}"></td>
				<td th:text="${l.get('memberId')}"></td>
				<td th:text="${l.get('memberName')}"></td>
				<td class="money"
					th:text="${#numbers.formatInteger(l.get('totalPrice'),3,'COMMA')+'원'}"></td>
				<td th:text="${l.get('payOkDate')}"></td>
			<tr th:unless="${not #lists.isEmpty(laundryByIncome)}">
				<td colspan="8">조회된 내용이 없습니다.</td>
			</tr>
		</tbody>
	</table>
	<nav id="GPNum">
		<ul class="pagination justify-content-center">
			<li class="page-item"><a class="page-link"
				th:href="@{/admin/lundryIncome}" tabindex="-1">처음</a></li>
			<th:block
				th:each="num : ${#numbers.sequence(startPageNum, endPageNum)}">
				<li class="page-item"></li>
				<li><a class="page-link" th:unless="${currentPage eq num}"
					th:href="@{/admin/lundryIncome(currentPage=${num})}"
					th:text="${(num < 5)? '0'+ num: num}"></a></li>
			</th:block>
			<li class="page-item">
			<li class="page-item"><a class="page-link"
				th:href="@{/admin/lundryIncome(currentPage=${lastPage})}">마지막</a></li>
		</ul>
	</nav>
</th:block>

<th:block layout:fragment="customJsScript">
	<script type="text/javascript">
		var tBody = document.querySelector('#tBody');
		var finalMoney = document.querySelector('#finalMoney');
		var money = tBody.querySelectorAll('.money');

		var sum = 0;
		for (var i = 0; i < money.length; i++) {
			mm = money[i].innerText.split('원', 1);
			var number = mm[0].replace(",", "");
			sum += Number(number);
		}
		console.log(sum);
		finalMoney.innerText = sum + "원";
	</script>
</th:block>
</html>