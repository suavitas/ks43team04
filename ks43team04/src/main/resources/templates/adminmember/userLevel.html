<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	  layout:decorate="~{layouts/adminDefault}">
	  
<th:block layout:fragment="customCss">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/limonte-sweetalert2/7.2.0/sweetalert2.min.css">
</th:block>	

<th:block layout:fragment="customJsScript2">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/limonte-sweetalert2/7.2.0/sweetalert2.all.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
	<script type="text/javascript">
		$(function() {
			$(document).on('click', '#confirmStart', function() {
				const data = {
			    	levelCode : $(this).parent().parent().parent().find('#levelCode').val()
		      	}
				console.log(data.levelCode);
				Swal.fire({
					title: '등록기준을 삭제 하시겠습니까?',
					text: '승인을 누르면 바로 삭제됩니다.',
					icon: 'warning',
					showCancelButton: true, 
					confirmButtonColor: '#3085d6', 
					cancelButtonColor: '#d33', 
					confirmButtonText: '승인', 
					cancelButtonText: '취소', 
					
					reverseButtons: true, // 버튼 순서 거꾸로
					   
				}).then(result => {
					var request = $.ajax({
						  method: "POST",
						  url: "/admin/removeUserlevel",
						  contentType: 'application/json; charset=utf-8',
						  data: JSON.stringify(data), 
						  dataType: "json"
						});
					Swal.fire({
							title: '삭제가 완료되었습니다.',
							icon: 'success'
				          }).then(() => { 
				        	  location.reload();			        	  
				          });
					request.fail(function( jqXHR, textStatus ) {
						  alert( "Request failed: " + textStatus );
					});
				});
			})
		})
	</script>
</th:block>	  
<style>
	.column-title {
		font-size: 8px;
	}
</style>	  
	  	  
	<!-- 사용자정의 contents -->
	<th:block layout:fragment="customContents">
   	<h4>회원등급 기준 및 혜택</h4>
   	<div class="col-md-12 col-sm-12 mt-5">
			<div class="x_panel">
			<h2>회원등급 기준</h2>
			<div class="x_title"></div>
			<div class="x_content">
				<a th:href="@{/admin/addUserLevel}"><input type="button"class="btn btn-info" value="등급 기준 등록"></a>
				  <div class="table-responsive">
					<div class="clearfix">
	                        <div class="float-left">
	                            <span>Total : </span>
	                        </div>
	                        <div class="float-right pr-2"></div>
                    </div>
						<table class="table table-striped jambo_table bulk_action" style="text-align: center;">					
							<thead>
								<tr class="headings">
									<th>
										<input type="checkbox" id="check-all" class="flat">
									</th>
									<th class="column-title">등급 종류</th>
									<th class="column-title">최소 이용금액</th>
									<th class="column-title">최대 이용금액</th>
									<th class="column-title">적립포인트 (%)</th>
									<th class="column-title">등록시각</th>
									<th class="column-title">수정시각</th>
									<th class="column-title">기준수정</th>
									<th class="column-title">기준삭제</th>
									<th class="bulk-actions" colspan="10">
										<a class="antoo" style="color:#fff; font-weight:500;">전체 선택 ( <span class="action-cnt"> </span> ) <i class="fa fa-chevron-down"></i></a>
									</th>
								</tr>
							</thead>
							<tbody>
								<tr th:if="${not #lists.isEmpty(getUserLevelList)}" th:each="l : ${getUserLevelList}" class="even pointer">						
									<td class="a-center">
										<input type="checkbox" class="flat" name="table_records">
										<input type="hidden" id="levelCode" th:value="${l.levelCode}">									
									</td>
									<td th:text="${l.levelName}" style="color: #2B4C64; font-size: 15px;"></td>
									<td th:text="${#numbers.formatInteger(l.userLevel.rangeStart,1,'COMMA') + '원 이상' }"></td>
									<td th:text="${#numbers.formatInteger(l.userLevel.rangeEnd,3,'COMMA') + '원 미만' }"></td>
									<td th:text="${l.userLevel.savePointPercent + '%' }"></td>
									<td th:text="${l.userLevel.registTime}"></td>
									<td th:text="${l.userLevel.updateTime}"></td>
									<td>
										<div style="text-align: center;">							
											<a th:href="@{/admin/detailLevel(levelCode=${l.levelCode})}"><button type="button" class="btn btn-warning btn-sm">수정</button></a>
										</div>
									</td>
									<td>
										<div style="text-align: center;">							
											<button class="btn btn-secondary btn-sm" id="confirmStart">삭제</button>
										</div>
									</td>
								</tr>
							</tbody>
						</table>
						
					</div>				
					<nav aria-label="Page navigation example">
						<ul class="pagination justify-content-center">
							<li class="page-item">
								<a class="page-link" th:href="@{/admin/userLevel}" tabindex="-1"> <
								</a>
							</li>
							<li class="page-item"><a class="page-link" href="#">1</a></li>
							<li class="page-item"><a class="page-link" href="#">2</a></li>
							<li class="page-item"><a class="page-link" href="#">3</a></li>
							<li class="page-item">
								<a class="page-link" href="#">></a>
							</li>
						</ul>
					</nav>
				</div>
			</div>	
		</div>
	
</th:block>
</html>
